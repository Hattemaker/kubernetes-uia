
== Hvorfor Kubernetes
 * kjøre applikasjoner uten å bry seg for mye om servere/nettverk
 * kjøre flere applikasjoner som prater sammen
 * håndtere oppgradering og sletting av applikasjoner ikke bare at man lager nye
 * kjøre en applikasjon i flere instanser og lastbalansere trafikk mellom dem

== Hvilke egenskaper gir det deg
 * oppgradere en applikasjon til en ny versjon i fart
 * rulle tilbake ved feil
 * skalere en applikasjon i flere instanser
 * styre trafikken til applikasjonen mellom forskjellige versjoner

== Kjerneprinsipper
 * deklarativ konfigurasjon i yaml eller json
 * konfigurasjon er ønsket tilstand
 * apiGrupper og ressurser
 * merkelapper (labels)

== Pod
- en pod er den minste 'deploybare' enheten på kubernetes
- alle andre høyere nivå konsepter har Pods i bunnen

== Pod Eksempel
[source,yaml]
----
include::../../../kubernetes/pod.yaml[]
----
== Service
- minste deploybare enhet for å lastbalansere og styre trafikk til applikasjoner
- opererer på ip/port nivå

== Service Eksempel
[source,yaml]
----
include::../../../kubernetes/service.yaml[]
----

== !
[.single-headline2]
 DEMO: kjøre vår app på Kubernetes via Docker for Mac

== Hva er problemet med denne løsningen?
 - Hvis poden forsvinner er den borte, akkurat som med docker
 - Skalering/lastbalansering er heller ikke håndtert
 - Hva skjer hvis deploy feiler?

== Deployment
 - høyere nivå konsept som komponerer ved å bruke pod
 - kan skalere i flere instanser
 - har en rekke 'sane' default verdier

== Deployment Eksempel
[source,yaml]
----
include::../../../kubernetes/deployment.yaml[]
----

== Demo livssyklus
 * fjerne pod og gammel service
 * deploy med deployment
 * vise
 ** rullerende oppgradering
 ** rulle tilbake ved feil


== !
image::images/kubernetes-architecture.png[canvas, size=cover]

== Ressurser
plantuml::kubernetes.puml["kubernetes","png"]

== Typer workload
- Jobs/CronJobs
- Deployment
- StatefulSet
- DaemonSet
